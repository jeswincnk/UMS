{% extends 'public/college/base.html' %}

{% block title %}Students - College Portal{% endblock %}

{% block content %}
<div class="page-header d-flex justify-content-between align-items-center">
  <div>
    <h1 class="page-title"><i class="fas fa-user-graduate"></i>Students</h1>
    <p class="page-subtitle">Manage students enrolled in your college</p>
  </div>
  <a href="{% url 'public:college_add_student' %}" class="btn btn-royal">
    <i class="fas fa-user-plus me-2"></i>Add Student
  </a>
</div>

<!-- Summary Cards -->
<div class="row g-4 mb-4">
  <div class="col-md-4">
    <div class="card card-stats">
      <div class="stat-icon">
        <i class="fas fa-users"></i>
      </div>
      <div class="stat-value">{{ students|length }}</div>
      <div class="stat-label">Total Students</div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card card-stats">
      <div class="stat-icon">
        <i class="fas fa-graduation-cap"></i>
      </div>
      <div class="stat-value">{{ departments_count }}</div>
      <div class="stat-label">Departments</div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card card-stats">
      <div class="stat-icon">
        <i class="fas fa-book"></i>
      </div>
      <div class="stat-value">{{ programs_count }}</div>
      <div class="stat-label">Programs</div>
    </div>
  </div>
</div>

<!-- Students List -->
<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <span><i class="fas fa-list"></i>Enrolled Students</span>
    <span class="badge bg-secondary">{{ students|length }} Students</span>
  </div>
  <div class="card-body p-0">
    {% if students %}
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead>
          <tr>
            <th>Student</th>
            <th>Email</th>
            <th>Department</th>
            <th>Program</th>
            <th>Roll No.</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for student in students %}
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <div class="user-avatar me-2" style="width: 38px; height: 38px; font-size: 0.8rem;">
                  {{ student.user.first_name|slice:":1"|upper }}{{ student.user.last_name|slice:":1"|upper }}
                </div>
                <div>
                  <strong>{{ student.user.get_full_name|default:student.user.email }}</strong>
                </div>
              </div>
            </td>
            <td>{{ student.user.email }}</td>
            <td>{{ student.department.name|default:"-" }}</td>
            <td>{{ student.program.name|default:"-" }}</td>
            <td><code>{{ student.roll_number|default:"-" }}</code></td>
            <td>
              <div class="btn-group btn-group-sm">
                <a href="{% url 'public:college_view_student' student.pk %}" class="btn btn-outline-secondary" title="View">
                  <i class="fas fa-eye"></i>
                </a>
                <a href="{% url 'public:college_edit_student' student.pk %}" class="btn btn-outline-secondary" title="Edit">
                  <i class="fas fa-edit"></i>
                </a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-5">
      <i class="fas fa-user-graduate fa-3x text-muted mb-3"></i>
      <h5 class="text-muted">No Students Enrolled Yet</h5>
      <p class="text-muted">Start by adding your first student to the college.</p>
      <a href="{% url 'public:college_add_student' %}" class="btn btn-royal mt-2">
        <i class="fas fa-user-plus me-2"></i>Add First Student
      </a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
